!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core")):"function"==typeof define&&define.amd?define("angular-google-tag-manager",["exports","@angular/core"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["angular-google-tag-manager"]={},e.ng.core)}(this,(function(e,t){"use strict";var n=function(){function e(e,t,n,o){if(void 0===e&&(e={id:null}),this.config=e,this.googleTagManagerId=t,this.googleTagManagerAuth=n,this.googleTagManagerPreview=o,this.isLoaded=!1,this.browserGlobals={windowRef:function(){return window},documentRef:function(){return document}},null==this.config&&(this.config={id:null}),this.config=Object.assign(Object.assign({},this.config),{id:t||this.config.id,gtm_auth:n||this.config.gtm_auth,gtm_preview:o||this.config.gtm_preview}),null==this.config.id)throw new Error("Google tag manager ID not provided.")}return e.prototype.getDataLayer=function(){var e=this.browserGlobals.windowRef();return e.dataLayer=e.dataLayer||[],e.dataLayer},e.prototype.pushOnDataLayer=function(e){this.getDataLayer().push(e)},e.prototype.addGtmToDom=function(){var e=this;return new Promise((function(t,n){if(e.isLoaded)return t(e.isLoaded);var o=e.browserGlobals.documentRef();e.pushOnDataLayer({"gtm.start":(new Date).getTime(),event:"gtm.js"});var r=o.createElement("script");r.id="GTMscript",r.async=!0,r.src=e.applyGtmQueryParams("https://www.googletagmanager.com/gtm.js"),r.addEventListener("load",(function(){return t(e.isLoaded=!0)})),r.addEventListener("error",(function(){return n(!1)})),o.head.insertBefore(r,o.head.firstChild)}))},e.prototype.pushTag=function(e){var t=this;return new Promise((function(n,o){return t.isLoaded||t.addGtmToDom().then((function(){return t.pushOnDataLayer(e),n()})).catch((function(){return o()})),t.pushOnDataLayer(e),n()}))},e.prototype.applyGtmQueryParams=function(e){var t=this;return-1===e.indexOf("?")&&(e+="?"),e+Object.keys(this.config).filter((function(e){return t.config[e]})).map((function(e){return e+"="+t.config[e]})).join("&")},e}();n.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],n.ctorParameters=function(){return[{type:void 0,decorators:[{type:t.Optional},{type:t.Inject,args:["googleTagManagerConfig"]}]},{type:String,decorators:[{type:t.Optional},{type:t.Inject,args:["googleTagManagerId"]}]},{type:String,decorators:[{type:t.Optional},{type:t.Inject,args:["googleTagManagerAuth"]}]},{type:String,decorators:[{type:t.Optional},{type:t.Inject,args:["googleTagManagerPreview"]}]}]},n.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new n(t.ɵɵinject("googleTagManagerConfig",8),t.ɵɵinject("googleTagManagerId",8),t.ɵɵinject("googleTagManagerAuth",8),t.ɵɵinject("googleTagManagerPreview",8))},token:n,providedIn:"root"});var o=function(){function e(){}return e.forRoot=function(t){return{ngModule:e,providers:[{provide:"googleTagManagerConfig",useValue:t}]}},e}();o.decorators=[{type:t.NgModule}],e.GoogleTagManagerModule=o,e.GoogleTagManagerService=n,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=angular-google-tag-manager.umd.min.js.map